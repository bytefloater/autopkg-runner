<!DOCTYPE html>
<html lang="en" data-bs-theme="auto">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="theme-color" content="#2b3035" media="(prefers-color-scheme: dark)">
    <meta name="theme-color" content="#f8f9fa" media="(prefers-color-scheme: light)">

    <title>AutoPkg Report</title>

    <link rel="preload" as="style" href="/site_assets/bootstrap.min.css">
    <link rel="preload" as="script" href="/site_assets/bootstrap.bundle.min.js">
    <link rel="preload" as="script" href="/site_assets/bootstrap-auto-dark-mode.js">

    <link rel="stylesheet" href="/site_assets/bootstrap.min.css">
    
    <script src="/site_assets/bootstrap.bundle.min.js"></script>
    <script src="/site_assets/bootstrap-auto-dark-mode.js"></script>
</head>
<style>
    body { display: flex; flex-direction: column; }
    h3 { padding-top: 20px; }
    svg { margin-top: -4px; }
    .badges { padding-top: 10px; }
    .navbar .container-fluid { justify-content: flex-start; }
    .content-container {
        display: inherit;
        flex-direction: column;
        align-self: center;
        width: 100vw;
        min-height: 20px;
        max-width: 1200px;
        padding: 12px
    }
    .table-container { overflow-x: scroll; }
</style>

<body>
    <nav class="navbar bg-body-tertiary">
        <div class="container-fluid">
            <div class="d-flex gap-2">
                <a href="/reports">
                    <button type="button" class="btn btn-outline-secondary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0"></path>
                        </svg>
                        Back
                    </button>
                </a>
            </div>
            <span class="navbar-brand mb-0 h1" style="margin-left: 10px;">AutoPkg Report</span>
        </div>
    </nav>

    <div class="content-container">
        <div class="card">
            <div class="card-body">
                This report was generated by {{ generator_name }} at {{ gen_time }} on {{ gen_date }}
                <div class="badges">
                    <span class="badge rounded-pill text-bg-danger">{{ failures.data_rows|length }} failures</span>
                    <span class="badge rounded-pill text-bg-success">{{ munki_imports.data_rows|length }} items imported into Munki</span>
                </div>
            </div>
        </div>


        {% if updated_trust_info.data_rows %}
        <!-- Recipes with updated trust info -->
        <h3>{{ updated_trust_info.summary_text }}</h3>
        <table class="table">
            <thead>
                <tr>
                    <th scope="col">Recipe</th>
                </tr>
            </thead>
            <tbody>
                {% for row in updated_trust_info.data_rows %}
                <tr>
                    <td scope="row">{{ row.recipe }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% endif %}


        {% if failures.data_rows %}
        <!-- Failures -->
        <h3>{{ failures.summary_text }}</h3>
        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">Recipe</th>
                        <th scope="col">Message</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in failures.data_rows %}
                    <tr>
                        <td scope="row">{{ row.recipe }}</td>
                        <td scope="row">{{ row.message }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}


        {% if updated_applications.data_rows %}
        <!-- Updated Applications -->
        <h3>New software was downloaded:</h3>
        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">Name</th>
                        <th>Version</th>
                    </tr>
                </thead>
                <tbody>
                    {% for app in updated_applications %}
                    <tr>
                        <td scope="row">{{ app.name }}</td>
                        <td>{{ app.version }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        {% if deprecations.data_rows %}
        <!-- Deprecations -->
        <h3>{{ deprecations.summary_text }}</h3>
        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">Name</th>
                        <th scope="col">Warning</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in deprecations.data_rows %}
                    <tr>
                        <td scope="row">{{ row.name }}</td>
                        <td scope="row">{{ row.warning }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        {% if urls_downloaded.data_rows %}
        <!-- New Items Downloaded-->
        <h3>{{ urls_downloaded.summary_text }}</h3>
        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">Items</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in urls_downloaded.data_rows %}
                    <tr>
                        <td scope="row">{{ row.download_path }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        {% if packages_copied.data_rows %}
        <!-- Packages Copied-->
        <h3>{{ packages_copied.summary_text }}</h3>
        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">Package</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in packages_copied.data_rows %}
                    <tr>
                        <td scope="row">{{ row.pkg_path }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        {% if munki_imports.data_rows %}
        <!-- Imported to Munki -->
        <h3>{{ munki_imports.summary_text }}</h3>
        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">Name</th>
                        <th scope="col">Version</th>
                        <th scope="col">Catalog</th>
                        <th scope="col">Package Info Path</th>
                        <th scope="col">Package Repo Path</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in munki_imports.data_rows %}
                    <tr>
                        <td scope="row">{{ row.name }}</td>
                        <td>{{ row.version }}</td>
                        <td>{{ row.catalogs }}</td>
                        <td>{{ row.pkginfo_path }}</td>
                        <td>{{ row.pkg_repo_path }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}
    </div>
</body>

</html>